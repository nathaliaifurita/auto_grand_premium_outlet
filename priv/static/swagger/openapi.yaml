openapi: 3.0.3

info:
  title: Auto Grand Premium Outlet API
  version: "1.0.0"
  description: API para gestÃ£o de veÃ­culos, vendas e pagamentos

servers:
  - url: http://localhost:4000/api

tags:
  - name: Vehicles
  - name: Sales
  - name: Payments

paths:
  /vehicles/available:
    get:
      tags: [Vehicles]
      summary: List available vehicles
      responses:
        '200':
          $ref: '#/components/responses/VehicleListResponse'

  /vehicles:
    post:
      tags: [Vehicles]
      summary: Create a new vehicle
      requestBody:
        $ref: '#/components/requestBodies/VehicleCreate'
      responses:
        '201':
          $ref: '#/components/responses/VehicleResponse'
        '422':
          $ref: '#/components/responses/ValidationError'

  /vehicles/sold:
    get:
      tags: [Vehicles]
      summary: List sold vehicles
      responses:
        '200':
          $ref: '#/components/responses/VehicleListResponse'

  /vehicles/{id}:
    get:
      tags: [Vehicles]
      summary: Get vehicle by ID
      parameters:
        - $ref: '#/components/parameters/VehicleId'
      responses:
        '200':
          $ref: '#/components/responses/VehicleResponse'
        '404':
          $ref: '#/components/responses/NotFoundError'

    put:
      tags: [Vehicles]
      summary: Update vehicle
      parameters:
        - $ref: '#/components/parameters/VehicleId'
      requestBody:
        $ref: '#/components/requestBodies/VehicleUpdate'
      responses:
        '200':
          $ref: '#/components/responses/VehicleResponse'
        '422':
          $ref: '#/components/responses/ValidationError'

  /sales:
    post:
      tags: [Sales]
      summary: Create a new sale
      requestBody:
        $ref: '#/components/requestBodies/SaleCreate'
      responses:
        '201':
          $ref: '#/components/responses/SaleResponse'

  /sales/{sale_id}/complete:
    put:
      tags: [Sales]
      summary: Complete a sale
      parameters:
        - $ref: '#/components/parameters/SaleId'
      responses:
        '200':
          $ref: '#/components/responses/SaleResponse'

  /sales/{sale_id}/cancel:
    put:
      tags: [Sales]
      summary: Cancel a sale
      parameters:
        - $ref: '#/components/parameters/SaleId'
      responses:
        '200':
          $ref: '#/components/responses/SaleResponse'

  /payments:
    post:
      tags: [Payments]
      summary: Create payment
      requestBody:
        $ref: '#/components/requestBodies/PaymentCreate'
      responses:
        '201':
          $ref: '#/components/responses/PaymentResponse'

  /payments/{payment_code}/confirm:
    put:
      tags: [Payments]
      summary: Confirm payment
      parameters:
        - $ref: '#/components/parameters/PaymentCode'
      responses:
        '200':
          $ref: '#/components/responses/PaymentResponse'

  /payments/{payment_code}/cancel:
    put:
      tags: [Payments]
      summary: Cancel payment
      parameters:
        - $ref: '#/components/parameters/PaymentCode'
      responses:
        '200':
          $ref: '#/components/responses/PaymentResponse'

components:

  ## ðŸ”¹ PARAMETERS
  parameters:
    VehicleId:
      name: id
      in: path
      required: true
      schema:
        type: string
        example: "veh_123"

    SaleId:
      name: sale_id
      in: path
      required: true
      schema:
        type: string
        example: "sale_123"

    PaymentCode:
      name: payment_code
      in: path
      required: true
      schema:
        type: string
        example: "pay_456"

  ## ðŸ”¹ REQUEST BODIES
  requestBodies:
    VehicleCreate:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/VehicleInput'

    VehicleUpdate:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/VehicleInput'

    SaleCreate:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/SaleInput'

    PaymentCreate:
      required: true
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/PaymentInput'

  ## ðŸ”¹ RESPONSES
  responses:
    VehicleResponse:
      description: Vehicle data
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Vehicle'

    VehicleListResponse:
      description: List of vehicles
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: '#/components/schemas/Vehicle'

    SaleResponse:
      description: Sale data
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Sale'

    PaymentResponse:
      description: Payment data
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Payment'

    ValidationError:
      description: Validation error
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

    NotFoundError:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'

  ## ðŸ”¹ SCHEMAS
  schemas:
    Vehicle:
      type: object
      required: [id, brand, model, year, color, price, status]
      properties:
        id:
          type: string
          default: vehicle-123
        brand:
          type: string
          default: Toyota
        model:
          type: string
          default: Corolla
        year:
          type: integer
          default: 2020
        color:
          type: string
          default: Black
        price:
          type: number
          default: 25000.00
        status:
          type: string
          enum: [available, sold]
          default: available

    VehicleInput:
      type: object
      required: [brand, model, year, color, price, license_plate]
      properties:
        brand:
          type: string
          default: Toyota
        model:
          type: string
          default: Corolla
        year:
          type: integer
          default: 2020
        color:
          type: string
          default: Black
        price:
          type: number
          default: 25000.00
        license_plate:
          type: string
          default: ABC1D34

    Sale:
      type: object
      required: [id, status, vehicles]
      properties:
        id:
          type: string
        status:
          type: string
          enum: [pending, completed, cancelled]
        vehicles:
          type: array
          items:
            $ref: '#/components/schemas/Vehicle'

    SaleInput:
      type: object
      required: [customer_id]
      properties:
        customer_id:
          type: string

    Payment:
      type: object
      required: [code, amount, status]
      properties:
        code:
          type: string
        amount:
          type: number
        status:
          type: string
          enum: [pending, confirmed, cancelled]

    PaymentInput:
      type: object
      required: [sale_id, amount]
      properties:
        sale_id:
          type: string
        amount:
          type: number

    Error:
      type: object
      required: [error, message]
      properties:
        error:
          type: string
          example: validation_error
        message:
          type: string
          example: Invalid price
